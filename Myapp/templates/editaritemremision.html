{% load static %}
{% load crispy_forms_tags %}
<html>
<head>
    <meta charset="utf-8">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js" integrity="sha384-7+zCNj/IqJ95wo16oMtfsKbZ9ccEh31eOz1HGyDuCQ6wgnyJNSYdrPa03rtR1zdB" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js" integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.20/css/jquery.dataTables.min.css">
    <link rel="" href="https://cdn.datatables.net/fixedheader/3.1.6/css/fixedHeader.dataTables.min.css">
    <title>Retiro Serial</title>
    <h1> Editar repuesto remision</h1>
    <p></p>
    <style>
    form {
            margin: 20px; /* Aade margen alrededor del formulario */
            padding: 20px; /* Aade espacio interno al formulario */
            background-color: #f5f5f5;
            border: 1px solid #ddd;
            border-radius: 5px;
        }

        /* Estilo para los campos de entrada */
        .form-control {
            margin-bottom: 10px;
            /* Otros estilos personalizados segn tus preferencias */
        }
    </style>

</head>
<body>
<form action="{% url 'edicionitemremision' %}" method="POST" onsubmit="capturarValorCheckbox()">
    {% csrf_token %}
    <input type="hidden" class="form-control" id="inputitemremision" name="itemremision" value="{{itemremision.id}}" readonly>
    <input type="hidden" class="form-control" id="inputremision" name="remision" value="{{itemremision.remision.id}}" readonly>
    <div class="row">
    <div class="col-md-2">
        <label for="inputserial" class="form-label"># Serie PMV a:</label>
        <input type="text" class="form-control" id="inputserial" value="{{ itemremision.codigomaquina.serie_PMV }}" readonly>
        <input type="hidden" class="form-control" id="inputserialoculto" name="serialoculto" value="{{ itemremision.codigomaquina.id}}" readonly>
    </div>
    <div class="col-md-5">
        <label for="inputcliente" class="form-label">Cliente:</label>
        <input type="text" class="form-control" id="inputcliente" name="cliente" value="{{itemremision.remision.clientes.nombre}}" readonly>
        <input type="hidden" class="form-control" id="inputclienteoculto" name="clienteoculto" value="{{itemremision.remision.clientes}}" readonly>
    </div>
    <div class="col-md-5">
        <label for="inputsala" class="form-label">Sala:</label>
        <input type="text" class="form-control" id="inputsala" name="sala" value="{{itemremision.sala.nombre}}" readonly>
        <input type="hidden" class="form-control" id="inputsala2" name="salaoculto" value="{{itemremision.sala}}" readonly>
    </div>
    <!--<div class="col-md-2">
        <label for="inputinspired" class="form-label">ID Inspired:</label>
        <input type="text" class="form-control" id="inputinspired" name="inspired" readonly>
    </div>
    <div class="col-md-2">
        <label for="inputposicion" class="form-label">Posición:</label>
        <input type="text" class="form-control" id="inputposicion" name="posicion" readonly>
    </div>--!>
<p></p>
    <div class="col-md-5">
        <label for="inputrepuesto" class="form-label">Repuesto:</label>
        <input type="text" class="form-control" id="inputrepuesto" name="repuesto" value="{{itemremision.repuesto}}" readonly>
        <input type="hidden" class="form-control" id="inputrepuestooculto" name="repuestooculto" value="{{itemremision.repuesto.id}}" readonly>
    </div>
    <div class="col-md-3">
        <label for="inputserialrepuestodespacho" class="form-label">Serial Repuesto Despacho:</label>
        <input type="text" class="form-control" id="inputserialrepuestodespacho" name="serialrepuestodespacho" value="{{itemremision.serialrepuestodespacho}}" readonly>
    </div>
    <div class="col-md-4">
        <label for="inputfechadespacho" class="form-label">Fecha Despacho Repuesto:</label>
        <input type="date" class="form-control" name="fechadespacho" id="inputfechadespacho" name="fechadespacho" value="{{itemremision.fechadespacho}}" readonly>
    </div>
    <p></p>
    <div class="col-md-3">
        <label for="inputserialrepuestoretorno" class="form-label">* Serial Repuesto Retorno:</label>
        <input type="text" class="form-control" id="inputserialrepuestoretorno" name="serialrepuestoretorno" required>
    </div>
    <div class="col-md-4">
        <label for="inputfecharecepcion" class="form-label">* Fecha Recepción Repuesto:</label>
        <input type="date" class="form-control" name="fecharetorno" id="inputfecharecepcion" required>
    </div>
    </div>
    <P></P>
    <CENTER>
    <button type="submit" class="btn btn-info">Guardar</button>
    <button type="button" class="btn btn-info" id="cerrarVentana">Cerrar</button>
    </CENTER>

</form>
<script>

    function capturarValorCheckbox() {
        var checkbox = document.getElementById("miCheckbox");
        var valor = checkbox.checked ? 1 : 0;
        // Asigna el valor al campo "ums" antes de enviar el formulario
        document.getElementById("ums").value = valor;
    }

    document.getElementById('cerrarVentana').addEventListener('click', function() {
        window.close(); // Cierra la ventana emergente
    });

    document.addEventListener("DOMContentLoaded", function () {
                const selectCodigoMaquina = document.getElementById("inputserial");
                const inputsala = document.getElementById("inputsala");
                const inputsala2 = document.getElementById("inputsala2");
                const datainspired = document.getElementById("inputinspired");
                const dataposicion = document.getElementById("inputposicion");

                selectCodigoMaquina.addEventListener("change", function () {
                  const selectedOption = selectCodigoMaquina.options[selectCodigoMaquina.selectedIndex];
                  inputsala.value = selectedOption.getAttribute("data-sala");
                  inputsala2.value = selectedOption.getAttribute("data-sala2");
                  inputinspired.value = selectedOption.getAttribute("data-inspired");
                  inputposicion.value = selectedOption.getAttribute("data-posicion");
               });
             });

    // Agrega este código para manejar los mensajes enviados desde la ventana emergente
    window.addEventListener("message", function (event) {
        if (event.data) {
            alert(event.data); // Muestra el mensaje de éxito en un cuadro de diálogo
            // También puedes realizar otras acciones, como actualizar la página principal
        }
    });


</script>
<p style="color: red; font-weight: bold;">Los campos marcados con * son obligatorios.</p>
<center>
    <fieldset>
        <div id="version">
            <h6>Ver. Verisón 1.0.0 (01/04/2022)</h6>
            <img src="{% static "img/logosistema.png" %}" > <br>
            <h8>Copyright ® 2019</h8>
            <br>
            <h8>SPOTGAMING S.A.S</h8>
            <br>
        </div>
    </fieldset>
</center>
</body>
</html>