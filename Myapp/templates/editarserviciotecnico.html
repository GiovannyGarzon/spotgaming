{% extends 'menusoporte.html' %}
{% load crispy_forms_tags %}
{% block content%}
<h1> Datos de la Orden de Servicio Tecnico</h1>
<p></p>
<form class="row g-3" action="{% url 'formeditarserviciotecnico' %}" method="POST">
    {% csrf_token %}
    <div class="col-md-4">
        <label for="inputnumero" class="form-label">Numero_TEC:</label>
        <input type="texto" class="form-control" id="inputnumerovisible" name="numero" value="TEC00-{{serviciostecnico.id}}" readonly onmousedown="return false;">
    </div>
    <input type="hidden" class="form-control" id="inputnumero" name="numero" value="{{serviciostecnico.id}}" readonly onmousedown="return false;">
    <div class="col-md-2">
        <label for="inputfechareporte" class="form-label">Fecha:</label>
        <input type="text" class="form-control" name="fecha" id="inputfechareporte" value="{{serviciostecnico.fecha}}" readonly onmousedown="return false;">
    </div>
    <div class="col-md-6">
        <label for="inpuclienteservicio" class="form-label">Cliente:</label>
        <input type="text" class="form-control" name="clienteserviciotecniconombre" id="inpuclienteservicio" value="{{serviciostecnico.clientes.nombre}}" readonly onmousedown="return false;">
    </div>
    <input type="hidden" class="form-control" name="clienteserviciotecnico" id="inpuclienteserviciooculto" value="{{serviciostecnico.clientes}}" required>
    <div class="col-md-4">
        <label for="inputfechareject" class="form-label">Fecha de Visita:</label>
        <input type="date" class="form-control" name="fechavisita" id="inputfechareject" value="{{serviciostecnico.fecha_visita}}" required>
    </div>
    <div class="col-md-8">
        <label for="tecnicoserviciotecniconombre" class="form-label">Tecnico Asignado:</label>
        <input type="text" class="form-control" name="tecnicoserviciotecniconombre" id="tecnicoserviciotecniconombre" value="{{serviciostecnico.tecnico.nombre}}" readonly onmousedown="return false;">
    </div>
    <input type="hidden" class="form-control" name="tecnicoserviciotecnico" id="tecnicoserviciotecnico" value="{{serviciostecnico.tecnico}}" readonly onmousedown="return false;">
    <div class="col-md-4">
        <label for="inputfechacierre" class="form-label">Fecha Cierre:</label>
        <input type="date" class="form-control" name="fechacierre" id="inputfechacierre" value="{{serviciostecnico.fecha_final}}">
    </div>
    <div class="col-md-4">
        <label for="inputstatus" class="form-label">Status:</label>
        <select id="inputstatus" class="form-select" name="statusserviciotecncio" required>
            <option>{{serviciostecnico.id_status}}</option>
            <option>PENDIENTE</option>
            <option>EN PROCESO</option>
            <option>CERRADA</option>
        </select>
    </div>
    <div class="col-md-12">
        <label for="inputdescripcion" class="form-label">Breve Descripción:</label>
        <input type="text" class="form-control" name="descripcion" id="inputdescripcion" value="{{serviciostecnico.descripcion}}" readonly onmousedown="return false;">
    </div>
    <table border="0" width="99%" id="table2" cellspacing="1" cellpadding="0" style="border: 1px solid #000000; padding-left:0; padding-right:0">
        <tbody><tr>
            <td bgcolor="#808080" align="center">
                <b><font face="Tahoma" size="2" color="#FFFFFF">Detalle del Servicio Técnico</font></b></td>
        </tr>
        </tbody>
    </table>
    <center>
        <style type="text/css">
    table {
        width: 100%;
        border-collapse: collapse;
    }

    th, td {
        padding: 10px;
        text-align: center;
        font-size: 15px; /* Tamaño de fuente para encabezados de tabla */
    }

    td {
        font-size: 80%; /* Tamaño de fuente para datos de tabla */
    }

    th {
        font-weight: bold; /* Opcional: hacer que los encabezados de tabla sean negritas */
    }

    </style>
    <table class="table table-bordered" >
        <thead>
        <tr>
            <!--<th scope="col">ID</th>--!>
            <th WIDTH="80" scope="col" style="text-align: center;">ID</th>
            <th WIDTH="80" scope="col" style="text-align: center;">Serie PMV</th>
            <th WIDTH="160" scope="col" style="text-align: center;">Sala / Punto</th>
            <th WIDTH="160" scope="col" style="text-align: center;">Falla reportada</th>
            <th WIDTH="80" scope="col" style="text-align: center;">Fecha Servicio</th>
            <th WIDTH="80" scope="col" style="text-align: center;">Fecha Solucion</th>
            <th WIDTH="80" scope="col" style="text-align: center;">Opciones</th>
        </tr>
        </thead>
        <tbody>
        {% for item in items_servicio_tecnico %}
            <tr>
                <td>{{ item.id }}</td>
                <td>{{ item.maquina.serie_PMV }}</td>
                <td>{{ item.Sala.nombre }}</td>
                <td>{{ item.observacion }}</td>
                <td>{{ item.fecha_visita|date:"Y-m-d" }}</td>
                <td>{% if item.fecha_cierre %}
                        {{item.fecha_cierre|date:"Y-m-d" }}
                        {% else %}
                            {{""}}
                {% endif %}</td>
                <td><a type="submit" class="btn btn-danger">Editar</a> | <button type="button" class="btn btn-danger">Ver</button></td>
            </tr>
        {% endfor %}
    </tbody>
    </table>
        </center>
    <div class="col-md-48">
        <label for="inputreporta" class="form-label">Observación:</label>
        <input type="text" class="form-control" name="observacion" id="inputreporta" value="{{serviciostecnico.observacion}}" required>
    </div>
    <p></p>
    <center>
        <fieldset id="borde2">
            <button type="button" class="btn btn-info" id="abrirVentanaEmergente" data-url="{% url 'agregaritemserviciotecnico' serviciostecnico.id %}">Agregar Item</button>
            <a type="button" class="btn btn-info">Carta</a>
            <a type="button" class="btn btn-info">Imprimir</a>
            <button type="submit" class="btn btn-info">Guardar</button>
            <a href="{% url 'listaserviciotecnico'%}" type="button" class="btn btn-info">Cerrar</a>
        </fieldset>
    </center>
</form>
<script>
document.getElementById('abrirVentanaEmergente').addEventListener('click', function() {
    var url = this.getAttribute('data-url');
    if (url) {
        window.open(url, 'VentanaEmergente', 'width=500,height=800,scrollbars=yes');
    }
});
</script>

{% endblock%}